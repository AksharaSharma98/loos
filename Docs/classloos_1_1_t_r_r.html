<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>LOOS: loos::TRR Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="classes.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceloos.html">loos</a>::<a class="el" href="classloos_1_1_t_r_r.html">TRR</a>
  </div>
</div>
<div class="contents">
<h1>loos::TRR Class Reference</h1><!-- doxytag: class="loos::TRR" --><!-- doxytag: inherits="loos::Trajectory" -->Class representing the GROMACS <a class="el" href="classloos_1_1_t_r_r.html" title="Class representing the GROMACS TRR trajectory files.">TRR</a> trajectory files.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="trr_8hpp-source.html">trr.hpp</a>&gt;</code>
<p>
<div class="dynheader">
Inheritance diagram for loos::TRR:</div>
<div class="dynsection">
<p><center><img src="classloos_1_1_t_r_r__inherit__graph.png" border="0" usemap="#loos_1_1_t_r_r__inherit__map" alt="Inheritance graph"></center>
<map name="loos_1_1_t_r_r__inherit__map">
<area shape="rect" href="classloos_1_1_trajectory.html" title="Base&#45;class for polymorphic trajectories." alt="" coords="5,5,120,40"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>
<div class="dynheader">
Collaboration diagram for loos::TRR:</div>
<div class="dynsection">
<p><center><img src="classloos_1_1_t_r_r__coll__graph.png" border="0" usemap="#loos_1_1_t_r_r__coll__map" alt="Collaboration graph"></center>
<map name="loos_1_1_t_r_r__coll__map">
<area shape="rect" href="classloos_1_1_trajectory.html" title="Base&#45;class for polymorphic trajectories." alt="" coords="21,112,136,147"><area shape="rect" href="classloos_1_1_stream_wrapper.html" title="Simple wrapper class for caching stream pointers." alt="" coords="5,5,152,40"><area shape="rect" href="classloos_1_1internal_1_1_x_d_r.html" title="This class provides some facility for handling XDR data." alt="" coords="320,112,459,147"><area shape="rect" href="classloos_1_1_coord.html" title="loos::Coord\&lt; double \&gt;" alt="" coords="483,112,640,147"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="classloos_1_1_t_r_r-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="be75880be87786b8dbb90f0e7f1ac9df"></a><!-- doxytag: member="loos::TRR::TRR" ref="be75880be87786b8dbb90f0e7f1ac9df" args="(const std::string &amp;s)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>TRR</b> (const std::string &amp;s)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f379a6abaf744ee3dc4ae992cc8b8d48"></a><!-- doxytag: member="loos::TRR::TRR" ref="f379a6abaf744ee3dc4ae992cc8b8d48" args="(const char *p)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>TRR</b> (const char *p)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b12a53209e683736bca3dccb1ed58003"></a><!-- doxytag: member="loos::TRR::TRR" ref="b12a53209e683736bca3dccb1ed58003" args="(std::iostream &amp;is)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>TRR</b> (std::iostream &amp;is)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d6477b0fa4f335ad4212fa398ba481e9"></a><!-- doxytag: member="loos::TRR::natoms" ref="d6477b0fa4f335ad4212fa398ba481e9" args="(void) const " -->
uint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_t_r_r.html#d6477b0fa4f335ad4212fa398ba481e9">natoms</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"># of atoms per frame <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_t_r_r.html#bb33ddd908ea79c00bf906d8df553edd">timestep</a> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4f5718dc10b172cb0536326259fa57b3"></a><!-- doxytag: member="loos::TRR::nframes" ref="4f5718dc10b172cb0536326259fa57b3" args="(void) const " -->
uint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_t_r_r.html#4f5718dc10b172cb0536326259fa57b3">nframes</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of frames in the trajectory. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_t_r_r.html#84d2b021cfff12205b4e8676da898166">hasPeriodicBox</a> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="68f65c5b9926674d007af5c192a2a169"></a><!-- doxytag: member="loos::TRR::periodicBox" ref="68f65c5b9926674d007af5c192a2a169" args="(void) const " -->
<a class="el" href="classloos_1_1_coord.html">GCoord</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_t_r_r.html#68f65c5b9926674d007af5c192a2a169">periodicBox</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the periodic box for the current frame/trajectory. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_t_r_r.html#8d762ad2518cc03a7fcb90aec5a4c62b">updateGroupCoords</a> (<a class="el" href="classloos_1_1_atomic_group.html">AtomicGroup</a> &amp;g)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the coordinates in an <a class="el" href="classloos_1_1_atomic_group.html" title="Class for handling groups of Atoms (pAtoms, actually).">AtomicGroup</a> with the current frame.  <a href="#8d762ad2518cc03a7fcb90aec5a4c62b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; <a class="el" href="classloos_1_1_coord.html">GCoord</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_t_r_r.html#3df5183ab84112b99669492cc8fc2858">coords</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the current frames coordinates as a vector of GCoords.  <a href="#3df5183ab84112b99669492cc8fc2858"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="51f3efc56abf8fb739923ded016f95f8"></a><!-- doxytag: member="loos::TRR::virial" ref="51f3efc56abf8fb739923ded016f95f8" args="(void) const " -->
std::vector&lt; double &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>virial</b> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="64523962ab809db617cda7ec4edcb376"></a><!-- doxytag: member="loos::TRR::pressure" ref="64523962ab809db617cda7ec4edcb376" args="(void) const " -->
std::vector&lt; double &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>pressure</b> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="698fdcea2d831f7f56e87fdf6bd239b4"></a><!-- doxytag: member="loos::TRR::velocities" ref="698fdcea2d831f7f56e87fdf6bd239b4" args="(void) const " -->
std::vector&lt; <a class="el" href="classloos_1_1_coord.html">GCoord</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>velocities</b> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b0af804fb7e30e9beaef34b73adbc37f"></a><!-- doxytag: member="loos::TRR::forces" ref="b0af804fb7e30e9beaef34b73adbc37f" args="(void) const " -->
std::vector&lt; <a class="el" href="classloos_1_1_coord.html">GCoord</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>forces</b> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="08e0f507f35c2d4d004a635a38a15483"></a><!-- doxytag: member="loos::TRR::isDouble" ref="08e0f507f35c2d4d004a635a38a15483" args="(void) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>isDouble</b> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="910023406b6313435548f084ec116924"></a><!-- doxytag: member="loos::TRR::hasVirial" ref="910023406b6313435548f084ec116924" args="(void) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>hasVirial</b> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="75401d538b9a77a2287c9b0a5b7ccf07"></a><!-- doxytag: member="loos::TRR::hasPressure" ref="75401d538b9a77a2287c9b0a5b7ccf07" args="(void) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>hasPressure</b> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="caec981697eadf428025c8a440fedfa5"></a><!-- doxytag: member="loos::TRR::hasCoords" ref="caec981697eadf428025c8a440fedfa5" args="(void) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>hasCoords</b> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="609dc50430f4ecb4c88055342e5b0467"></a><!-- doxytag: member="loos::TRR::hasVelocities" ref="609dc50430f4ecb4c88055342e5b0467" args="(void) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>hasVelocities</b> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c61e921c8b8fca10aba5a83befb792de"></a><!-- doxytag: member="loos::TRR::hasForces" ref="c61e921c8b8fca10aba5a83befb792de" args="(void) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>hasForces</b> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="aa1113c9aa9bcdb6428248f897576187"></a><!-- doxytag: member="loos::TRR::time" ref="aa1113c9aa9bcdb6428248f897576187" args="(void) const " -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>time</b> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5b220d56f3d9575c7b7b08f7fcee291f"></a><!-- doxytag: member="loos::TRR::lambda" ref="5b220d56f3d9575c7b7b08f7fcee291f" args="(void) const " -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>lambda</b> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="16a251142f729f3fce5c3f1256261b5e"></a><!-- doxytag: member="loos::TRR::step" ref="16a251142f729f3fce5c3f1256261b5e" args="(void) const " -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>step</b> (void) const </td></tr>

<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><b>Header</b></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Class representing the GROMACS <a class="el" href="classloos_1_1_t_r_r.html" title="Class representing the GROMACS TRR trajectory files.">TRR</a> trajectory files. 
<p>
The <a class="el" href="classloos_1_1_t_r_r.html" title="Class representing the GROMACS TRR trajectory files.">TRR</a> format can technically have differing numbers of atoms or even components (ie coords, velocities, forces) per frame. This is supported by LOOS, to an extent. If the components vary, then so long as there are coordinates, there should be no problem. If the number of atoms vary and you're using the <a class="el" href="classloos_1_1_t_r_r.html#8d762ad2518cc03a7fcb90aec5a4c62b" title="Update the coordinates in an AtomicGroup with the current frame.">updateGroupCoords()</a> function, then care must be taken that the group matches the frame. Recall that the atomids are actually indices into the trajectory frame (ie atomid 1 takes its coords from the first trajectory coordinate, etc).<p>
The <a class="el" href="classloos_1_1_t_r_r.html" title="Class representing the GROMACS TRR trajectory files.">TRR</a> format can be written in either a single or double precision format. Internally, LOOS will read in either and translate it into whatever the default size is for LOOS (ie GCoord, which by default is a double). Metadata, such as lambda, or box sizes, are always upconverted to double by LOOS.<p>
Since the <a class="el" href="classloos_1_1_t_r_r.html" title="Class representing the GROMACS TRR trajectory files.">TRR</a> frame size is not fixed, the entire trajectory will be quickly scanned to build up an index of where the frames begin (see the <a class="el" href="classloos_1_1_x_t_c.html" title="Class representing GROMACS reduced precision, compressed trajectories.">loos::XTC</a> class for more information).<p>
Finally, note that GROMACS stores data in nm whereas LOOS uses angstroms, so coordinate/box data will be automatically scaled by LOOS. 
<p>Definition at line <a class="el" href="trr_8hpp-source.html#l00078">78</a> of file <a class="el" href="trr_8hpp-source.html">trr.hpp</a>.</p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="bb33ddd908ea79c00bf906d8df553edd"></a><!-- doxytag: member="loos::TRR::timestep" ref="bb33ddd908ea79c00bf906d8df553edd" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float loos::TRR::timestep           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
GROMACS trajectories do not define a timestep value as <a class="el" href="classloos_1_1_d_c_d.html" title="Class for reading DCD files.">DCD</a> does 
<p>Implements <a class="el" href="classloos_1_1_trajectory.html#18fe23483971739427aee7bc92d73160">loos::Trajectory</a>.</p>

<p>Definition at line <a class="el" href="trr_8hpp-source.html#l00123">123</a> of file <a class="el" href="trr_8hpp-source.html">trr.hpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="84d2b021cfff12205b4e8676da898166"></a><!-- doxytag: member="loos::TRR::hasPeriodicBox" ref="84d2b021cfff12205b4e8676da898166" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool loos::TRR::hasPeriodicBox           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Tests whether or not the given frame/trajectory has periodic boundary information. The presence of periodic box information does not necessarily indicate that said information has been read in yet. For example, the presence of crystal data is in the header so this can be detected before any frame is read, but the crystal data itself is only read when a frame is read in. 
<p>Implements <a class="el" href="classloos_1_1_trajectory.html#615d45227feed4869c57e4a3a5440c85">loos::Trajectory</a>.</p>

<p>Definition at line <a class="el" href="trr_8hpp-source.html#l00126">126</a> of file <a class="el" href="trr_8hpp-source.html">trr.hpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="8d762ad2518cc03a7fcb90aec5a4c62b"></a><!-- doxytag: member="loos::TRR::updateGroupCoords" ref="8d762ad2518cc03a7fcb90aec5a4c62b" args="(AtomicGroup &amp;g)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loos::TRR::updateGroupCoords           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classloos_1_1_atomic_group.html">AtomicGroup</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>g</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Update the coordinates in an <a class="el" href="classloos_1_1_atomic_group.html" title="Class for handling groups of Atoms (pAtoms, actually).">AtomicGroup</a> with the current frame. 
<p>
As with the <a class="el" href="classloos_1_1_t_r_r.html#3df5183ab84112b99669492cc8fc2858" title="Returns the current frames coordinates as a vector of GCoords.">coords()</a> member function, some formats may have non-interleaved coordinate data making the copying of coordinates that much more expensive.<p>
In the case that the group is smaller than the trajectory frame, it is assumed that the atomic-id's of the group are indices into the frame's coordinates... Since atom-id's usually begin with 1 and not 0, the indices are necessarily shifted by -1.<p>
If the trajectory has periodic boundary information, then the group's periodicBox will also be updated. 
<p>Implements <a class="el" href="classloos_1_1_trajectory.html#663726128c09dd9f456dfb7bd0c75a19">loos::Trajectory</a>.</p>

<p>Definition at line <a class="el" href="trr_8cpp-source.html#l00149">149</a> of file <a class="el" href="trr_8cpp-source.html">trr.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="3df5183ab84112b99669492cc8fc2858"></a><!-- doxytag: member="loos::TRR::coords" ref="3df5183ab84112b99669492cc8fc2858" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classloos_1_1_coord.html">GCoord</a>&gt; loos::TRR::coords           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the current frames coordinates as a vector of GCoords. 
<p>
Some formats, notably DCDs, do not interleave their coordinates. This means that this could be a potentially expensive operation. 
<p>Implements <a class="el" href="classloos_1_1_trajectory.html#b600f0488189a7cdabcc200fdd4f77d5">loos::Trajectory</a>.</p>

<p>Definition at line <a class="el" href="trr_8hpp-source.html#l00131">131</a> of file <a class="el" href="trr_8hpp-source.html">trr.hpp</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="trr_8hpp-source.html">trr.hpp</a><li><a class="el" href="trr_8cpp-source.html">trr.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Thu Apr 22 17:00:59 2010 for LOOS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
