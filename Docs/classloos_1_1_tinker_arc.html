<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>LOOS: loos::TinkerArc Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="classes.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceloos.html">loos</a>::<a class="el" href="classloos_1_1_tinker_arc.html">TinkerArc</a>
  </div>
</div>
<div class="contents">
<h1>loos::TinkerArc Class Reference</h1><!-- doxytag: class="loos::TinkerArc" --><!-- doxytag: inherits="loos::Trajectory" -->Class for handling Tinker ARC files (concatenation of .xyz files).  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="tinker__arc_8hpp-source.html">tinker_arc.hpp</a>&gt;</code>
<p>
<div class="dynheader">
Inheritance diagram for loos::TinkerArc:</div>
<div class="dynsection">
<p><center><img src="classloos_1_1_tinker_arc__inherit__graph.png" border="0" usemap="#loos_1_1_tinker_arc__inherit__map" alt="Inheritance graph"></center>
<map name="loos_1_1_tinker_arc__inherit__map">
<area shape="rect" href="classloos_1_1_trajectory.html" title="Base&#45;class for polymorphic trajectories." alt="" coords="7,5,121,40"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>
<div class="dynheader">
Collaboration diagram for loos::TinkerArc:</div>
<div class="dynsection">
<p><center><img src="classloos_1_1_tinker_arc__coll__graph.png" border="0" usemap="#loos_1_1_tinker_arc__coll__map" alt="Collaboration graph"></center>
<map name="loos_1_1_tinker_arc__coll__map">
<area shape="rect" href="classloos_1_1_trajectory.html" title="Base&#45;class for polymorphic trajectories." alt="" coords="27,219,141,253"><area shape="rect" href="classloos_1_1_stream_wrapper.html" title="Simple wrapper class for caching stream pointers." alt="" coords="5,112,152,147"><area shape="rect" href="classloos_1_1_tinker_x_y_z.html" title="Class for reading a subset of the TinkerXYZ format." alt="" coords="168,219,291,253"><area shape="rect" href="classloos_1_1_atomic_group.html" title="Class for handling groups of Atoms (pAtoms, actually)." alt="" coords="176,112,309,147"><area shape="rect" href="classloos_1_1_shared_periodic_box.html" title="This class manages a shared Periodicbox." alt="" coords="159,5,327,40"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="classloos_1_1_tinker_arc-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1e80f1a3053cf9e8d58bef71e1c00c96"></a><!-- doxytag: member="loos::TinkerArc::TinkerArc" ref="1e80f1a3053cf9e8d58bef71e1c00c96" args="(const std::string &amp;s)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>TinkerArc</b> (const std::string &amp;s)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3ea21fb41c150e416404ef072bd818eb"></a><!-- doxytag: member="loos::TinkerArc::TinkerArc" ref="3ea21fb41c150e416404ef072bd818eb" args="(const char *p)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>TinkerArc</b> (const char *p)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5c7753ff05ea5cd2fd11b50ee932545a"></a><!-- doxytag: member="loos::TinkerArc::TinkerArc" ref="5c7753ff05ea5cd2fd11b50ee932545a" args="(std::iostream &amp;is)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>TinkerArc</b> (std::iostream &amp;is)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="21a21ca090e0ba73b31e29f819db6836"></a><!-- doxytag: member="loos::TinkerArc::nframes" ref="21a21ca090e0ba73b31e29f819db6836" args="(void) const " -->
virtual uint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_tinker_arc.html#21a21ca090e0ba73b31e29f819db6836">nframes</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of frames in the trajectory. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8b606a84b7976e6e3ef7adb17135517a"></a><!-- doxytag: member="loos::TinkerArc::natoms" ref="8b606a84b7976e6e3ef7adb17135517a" args="(void) const " -->
virtual uint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_tinker_arc.html#8b606a84b7976e6e3ef7adb17135517a">natoms</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"># of atoms per frame <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual std::vector&lt; <a class="el" href="classloos_1_1_coord.html">GCoord</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_tinker_arc.html#c1b1d4d3206943fa70902f4da19c8e64">coords</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the current frames coordinates as a vector of GCoords.  <a href="#c1b1d4d3206943fa70902f4da19c8e64"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_tinker_arc.html#932fc28d0cc35e6b22fead459d42dc4d">updateGroupCoords</a> (<a class="el" href="classloos_1_1_atomic_group.html">AtomicGroup</a> &amp;g)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the coordinates in an <a class="el" href="classloos_1_1_atomic_group.html" title="Class for handling groups of Atoms (pAtoms, actually).">AtomicGroup</a> with the current frame.  <a href="#932fc28d0cc35e6b22fead459d42dc4d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_tinker_arc.html#bb894526151fb62f8ecc7c6440e8b876">hasPeriodicBox</a> (void) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3ec4e6b5b208dbf7e896ea0f6fbcd453"></a><!-- doxytag: member="loos::TinkerArc::periodicBox" ref="3ec4e6b5b208dbf7e896ea0f6fbcd453" args="(void) const " -->
virtual <a class="el" href="classloos_1_1_coord.html">GCoord</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_tinker_arc.html#3ec4e6b5b208dbf7e896ea0f6fbcd453">periodicBox</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the periodic box for the current frame/trajectory. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ccfcb281fe660306b56ded5f4e571c0a"></a><!-- doxytag: member="loos::TinkerArc::timestep" ref="ccfcb281fe660306b56ded5f4e571c0a" args="(void) const " -->
virtual float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_tinker_arc.html#ccfcb281fe660306b56ded5f4e571c0a">timestep</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Timestep per frame. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classloos_1_1_tinker_x_y_z.html">TinkerXYZ</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classloos_1_1_tinker_arc.html#fee44a3bb39661abdb9210d8b6ebcb87">currentFrame</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the contained <a class="el" href="classloos_1_1_tinker_x_y_z.html" title="Class for reading a subset of the TinkerXYZ format.">TinkerXYZ</a> object.  <a href="#fee44a3bb39661abdb9210d8b6ebcb87"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Class for handling Tinker ARC files (concatenation of .xyz files). 
<p>
This class reads a concatenated .xyz tinker trajectory (i.e. an ARC file). In order to determine the number of frames present, the trajectory is scanned from beginning to end upon instantiation. A list of seek indices for each frame is also built.<p>
The first frame is read in by init(), so there is no explicit <a class="el" href="classloos_1_1_trajectory.html#65e93d6e22452d9d6f289997dc3664b3" title="Reads the next frame in a trajectory, returning false if at the end.">readFrame()</a> during initialization.<p>
There seems to be an issue with some .ARC files where reading the end of the contained <a class="el" href="classloos_1_1_tinker_x_y_z.html" title="Class for reading a subset of the TinkerXYZ format.">TinkerXYZ</a> object does not put the input stream into an EOF state. So, we can't depend on checking eof() in parseFrame() to flag when we've iterated off the end. <a class="el" href="classloos_1_1_tinker_arc.html" title="Class for handling Tinker ARC files (concatenation of .xyz files).">TinkerArc</a> therefore keeps track of what index into the <a class="el" href="classloos_1_1_trajectory.html" title="Base-class for polymorphic trajectories.">Trajectory</a> it's at and uses that to check to see if it's at the end or not.<p>
It is possible to get the contained <a class="el" href="classloos_1_1_tinker_x_y_z.html" title="Class for reading a subset of the TinkerXYZ format.">TinkerXYZ</a> object out of a <a class="el" href="classloos_1_1_tinker_arc.html" title="Class for handling Tinker ARC files (concatenation of .xyz files).">TinkerArc</a>, but with certain caveats. See <a class="el" href="classloos_1_1_c_c_p_d_b.html#069933c7dc10bb9d5893744f40efd742" title="Returns the current frame as a PDB object.">CCPDB::currentFrame()</a> for more details. 
<p>Definition at line <a class="el" href="tinker__arc_8hpp-source.html#l00060">60</a> of file <a class="el" href="tinker__arc_8hpp-source.html">tinker_arc.hpp</a>.</p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="c1b1d4d3206943fa70902f4da19c8e64"></a><!-- doxytag: member="loos::TinkerArc::coords" ref="c1b1d4d3206943fa70902f4da19c8e64" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classloos_1_1_coord.html">GCoord</a> &gt; loos::TinkerArc::coords           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the current frames coordinates as a vector of GCoords. 
<p>
Some formats, notably DCDs, do not interleave their coordinates. This means that this could be a potentially expensive operation. 
<p>Implements <a class="el" href="classloos_1_1_trajectory.html#b600f0488189a7cdabcc200fdd4f77d5">loos::Trajectory</a>.</p>

<p>Definition at line <a class="el" href="tinker__arc_8cpp-source.html#l00087">87</a> of file <a class="el" href="tinker__arc_8cpp-source.html">tinker_arc.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="932fc28d0cc35e6b22fead459d42dc4d"></a><!-- doxytag: member="loos::TinkerArc::updateGroupCoords" ref="932fc28d0cc35e6b22fead459d42dc4d" args="(AtomicGroup &amp;g)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void loos::TinkerArc::updateGroupCoords           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classloos_1_1_atomic_group.html">AtomicGroup</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>g</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Update the coordinates in an <a class="el" href="classloos_1_1_atomic_group.html" title="Class for handling groups of Atoms (pAtoms, actually).">AtomicGroup</a> with the current frame. 
<p>
As with the <a class="el" href="classloos_1_1_tinker_arc.html#c1b1d4d3206943fa70902f4da19c8e64" title="Returns the current frames coordinates as a vector of GCoords.">coords()</a> member function, some formats may have non-interleaved coordinate data making the copying of coordinates that much more expensive.<p>
In the case that the group is smaller than the trajectory frame, it is assumed that the atomic-id's of the group are indices into the frame's coordinates... Since atom-id's usually begin with 1 and not 0, the indices are necessarily shifted by -1.<p>
If the trajectory has periodic boundary information, then the group's periodicBox will also be updated. 
<p>Implements <a class="el" href="classloos_1_1_trajectory.html#663726128c09dd9f456dfb7bd0c75a19">loos::Trajectory</a>.</p>

<p>Definition at line <a class="el" href="tinker__arc_8hpp-source.html#l00073">73</a> of file <a class="el" href="tinker__arc_8hpp-source.html">tinker_arc.hpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="bb894526151fb62f8ecc7c6440e8b876"></a><!-- doxytag: member="loos::TinkerArc::hasPeriodicBox" ref="bb894526151fb62f8ecc7c6440e8b876" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool loos::TinkerArc::hasPeriodicBox           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Tests whether or not the given frame/trajectory has periodic boundary information. The presence of periodic box information does not necessarily indicate that said information has been read in yet. For example, the presence of crystal data is in the header so this can be detected before any frame is read, but the crystal data itself is only read when a frame is read in. 
<p>Implements <a class="el" href="classloos_1_1_trajectory.html#615d45227feed4869c57e4a3a5440c85">loos::Trajectory</a>.</p>

<p>Definition at line <a class="el" href="tinker__arc_8hpp-source.html#l00075">75</a> of file <a class="el" href="tinker__arc_8hpp-source.html">tinker_arc.hpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="fee44a3bb39661abdb9210d8b6ebcb87"></a><!-- doxytag: member="loos::TinkerArc::currentFrame" ref="fee44a3bb39661abdb9210d8b6ebcb87" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classloos_1_1_tinker_x_y_z.html">TinkerXYZ</a> loos::TinkerArc::currentFrame           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the contained <a class="el" href="classloos_1_1_tinker_x_y_z.html" title="Class for reading a subset of the TinkerXYZ format.">TinkerXYZ</a> object. 
<p>
See <a class="el" href="classloos_1_1_c_c_p_d_b.html#069933c7dc10bb9d5893744f40efd742" title="Returns the current frame as a PDB object.">CCPDB::currentFrame()</a> for some important notes about using this function. 
<p>Definition at line <a class="el" href="tinker__arc_8hpp-source.html#l00084">84</a> of file <a class="el" href="tinker__arc_8hpp-source.html">tinker_arc.hpp</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="tinker__arc_8hpp-source.html">tinker_arc.hpp</a><li><a class="el" href="tinker__arc_8cpp-source.html">tinker_arc.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Thu Apr 22 17:00:59 2010 for LOOS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
